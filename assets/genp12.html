<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="${pure_css_uri}">
    <link rel="stylesheet" type="text/css" href="${ext_css_uri}">
    <title>Csr Generator</title>
</head>

<body>
    <div class="pure-g">
        <div class="pure-u-1-5"></div>
        <div class="pure-u-3-5">
            <h1>Generate PKCS#12</h1>
        </div>
    </div>
    <div class="pure-g">
        <div class="pure-u-1-5"></div>
        <div class="pure-u-3-5">
            <form class="pure-form pure-form-aligned">
                <fieldset>
                    <div class="pure-control-group">
                        <label for="key">Key file</label>
                        <input class="pure-input-2-3 opensslutils-input" id="key" type="text" readonly>
                        <button onclick="chooseFile('key')" class="pure-button pure-button-primary">Browse</button>
                    </div>
                    <div class="pure-control-group">
                        <label for="cert">Certificate file</label>
                        <input class="pure-input-2-3 opensslutils-input" id="cert" type="text" readonly>
                        <button onclick="chooseFile('cert')" class="pure-button pure-button-primary">Browse</button>
                    </div>
                    <div class="pure-control-group">
                        <label for="bundle">CA's certificates file</label>
                        <input class="pure-input-2-3 opensslutils-input" id="bundle" type="text" readonly>
                        <button onclick="chooseFile('bundle')" class="pure-button pure-button-primary">Browse</button>
                    </div>
                    <div class="pure-control-group">
                        <label for="alias">Key alias</label>
                        <input class="pure-input-2-3 opensslutils-input" id="alias" type="text">
                    </div>
                    <div class="pure-control-group">
                        <label for="pwd">Password</label>
                        <input class="pure-input-2-3 opensslutils-input" id="pwd" type="password">
                    </div>
                    <div class="pure-control-group">
                        <label for="repwd">Confirm password</label>
                        <input class="pure-input-2-3 opensslutils-input" id="repwd" type="password">
                    </div>
                    <div class="pure-controls">
                        <button onclick="submitData()" class="button-xlarge pure-button pure-button-primary">Generate</button>
                    </div>
                </fieldset>
            </form>
        </div>
    </div>


    <script>
        const vscode = acquireVsCodeApi();
        window.addEventListener('message', (msg) => {
            console.log('message received');
            if (msg.data.command.startsWith('set-')) {
                const what = msg.data.command.substring(4);
                document.getElementById(what).value = msg.data.file;
            }
        });
        function chooseFile(type) {
            vscode.postMessage({
                command: `choose-${type}`
            });
        }
        function submitData() {
            vscode.postMessage({
                command: 'export',
                key: document.getElementById('key').value,
                cert: document.getElementById('cert').value,
                bundle: document.getElementById('bundle').value,
                alias: document.getElementById('alias').value,
                pwd: document.getElementById('pwd').value,
                repwd: document.getElementById('repwd').value
            });
        }
    </script>
</body>

</html>